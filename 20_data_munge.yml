target_default: 20_data_munge

packages:
  - scipiper
  - dplyr
  
sources:
  - 20_data_munge/src/munge_data_files.R
  
targets:
  20_data_munge:
    depends:
      - 20_data_munge/out/daily_flow.rds.ind
      - 20_data_munge/out/active_flow_gages.rds.ind
    
  # reduce uv to dailies, add source col, bring it all together. 
  20_data_munge/out/daily_flow.rds.ind:
    command: combine_all_dat(
      nwis_dv_ind  = '10_nwis_pull/out/nwis_dv_data.rds.ind',
      nwis_uv_ind = '10_nwis_pull/out/nwis_uv_data.rds.ind',
      out_ind = target_name)
      
  20_data_munge/out/daily_flow.rds:
    command: s3_get('20_data_munge/out/daily_flow.rds.ind')

  # tally how many active flow gages there were per year
  20_data_munge/out/active_flow_gages.rds.ind:
    command: tally_active_flow_gages(
      out_ind = target_name,
      all_dat_ind  = '20_data_munge/out/daily_flow.rds.ind',
      min_days_active = 335)
      
  20_data_munge/out/active_flow_gages.rds:
    command: s3_get('20_data_munge/out/active_flow_gages.rds.ind')
